###########################################
#
# light Decisions for Sons of Abraham
#
###########################################
# Written by Henrik Fåhraeus
###########################################

decisions = {
	observe_light_festival = {	light_fair = {
		only_playable = yes
		potential = {
			is_playable = yes
			religion_group = christian
			prisoner = no
			NOT = {
				has_character_modifier = holding_light_fair
			}
			NOT = {
				has_character_modifier = light_fair_timer
			}
			num_of_vassals = 1
			OR = {
				NOT = { has_character_flag = recent_light_fair }
				had_character_flag = {
					flag = recent_light_fair
					days = 60
				}
			}
		}
		allow = {
			war = no
			any_demesne_title = {
				NOT = { higher_tier_than = count }
				is_occupied = no
			}
			wealth = 25
			prisoner = no
			NOT = { is_inaccessible_trigger = yes }
			month = 4
			NOT = {
				month = 7
			}
			custom_tooltip = {
				text = is_not_busy_trigger_tooltip
				hidden_tooltip = { NOT = { has_character_flag = do_not_disturb } }
			}
		}
		effect = {
			wealth = -25
			add_character_modifier = {
				name = holding_light_fair
				duration = -1
			}
			set_character_flag = recent_minor_decision
			set_character_flag = do_not_disturb
			hidden_tooltip = {
				character_event = {
					id = 74047
					days = 60
				}
				character_event = { id = LF.0  }
			}
			if = {
				limit = {
					has_dlc = "Reapers"
				}
				custom_tooltip = {
					text = capital_prospers_custom_tooltip
					hidden_tooltip = {
						capital_scope = {
							change_variable = { which = prosperity_value value = 8 }
						}
					}
				}
			}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			
			modifier = {
				factor = 0
				NOT = {
					wealth = 200
				}
			}

			modifier = {
				factor = 0
				trait = slothful
			}	
			
			modifier = {
				factor = 0
				NOT = { stewardship = 10 }
			}
			
			modifier = {
				factor = 0
				has_character_flag = recent_minor_decision
				NOT = {
					had_character_flag = {
						flag = recent_minor_decision
						days = 730
					}
				}
			}			
			
		}
	}
	observe_picori_festival = {
		potential = {
			ai = no
			is_ruler = yes
			prisoner = no
			is_adult = yes
			OR = {
				religion = light_force
				AND = {
					has_title = k_hyrule_minish
					religion = golden_goddesses
				}
			}
			has_world_flag = era_force
			NOT = {
				has_character_modifier = holding_religious_feastival
			}
			NOT = {
				has_character_modifier = large_feast_timer
			}
			NOT = {
				has_character_modifier = fabulous_feast
			}
			NOT = {
				has_character_flag = guest_religious_feastival_started
			}
			NOT = { trait = incapable }
			num_of_vassals = 1
		}
		allow = {
			war = no
			any_demesne_title = {
				is_occupied = no
			}
			prisoner = no
			NOT = { trait = in_hiding }
			scaled_wealth = 0.2
			month = 9
			prestige = 100
			custom_tooltip = {
				text = is_not_busy_trigger_tooltip
				hidden_tooltip = { NOT = { has_character_flag = do_not_disturb } }
			}
		}
		effect = {
			scaled_wealth = -0.2
			add_character_modifier = {
				name = holding_religious_feastival
				duration = 365
			}
			set_character_flag = recent_minor_decision
			set_character_flag = do_not_disturb
			hidden_tooltip = { character_event = { id = HKRC.x1 } }
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 0.1
			modifier = {
				factor = 0
				NOT = {
					scaled_wealth = 2
				}
			}
			modifier = {
				factor = 0.5
				trait = shy
			}
			modifier = {
				factor = 0.5
				NOT = { diplomacy = 10 }
			}	
			modifier = {
				factor = 0
				has_character_flag = recent_minor_decision
				NOT = {
					had_character_flag = {
						flag = recent_minor_decision
						days = 730
					}
				}
			}	
			modifier = {
				factor = 0
				NOT = { age = 30 }
			}			
		}
	}
	observe_lunar_festival = { #festival from dusk to dawn, symbolising the death and rebirth of hylia
		potential = {
			ai = no
			is_ruler = yes
			prisoner = no
			is_adult = yes
			religion = sheikahism
			NOT = {
				has_character_modifier = holding_religious_feastival
			}
			NOT = {
				has_character_modifier = large_feast_timer
			}
			NOT = {
				has_character_modifier = fabulous_feast
			}
			NOT = {
				has_character_flag = guest_religious_feastival_started
			}
			NOT = { trait = incapable }
			num_of_vassals = 1
		}
		allow = {
			war = no
			any_demesne_title = {
				is_occupied = no
			}
			prisoner = no
			NOT = { trait = in_hiding }
			scaled_wealth = 0.2
			month = 9
			prestige = 100
			custom_tooltip = {
				text = is_not_busy_trigger_tooltip
				hidden_tooltip = { NOT = { has_character_flag = do_not_disturb } }
			}
		}
		effect = {
			scaled_wealth = -0.2
			add_character_modifier = {
				name = holding_religious_feastival
				duration = 365
			}
			set_character_flag = recent_minor_decision
			set_character_flag = do_not_disturb
			hidden_tooltip = { character_event = { id = HKRC.x2 } }
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 0.1
			modifier = {
				factor = 0
				NOT = {
					scaled_wealth = 2
				}
			}
			modifier = {
				factor = 0.5
				trait = shy
			}
			modifier = {
				factor = 0.5
				NOT = { diplomacy = 10 }
			}	
			modifier = {
				factor = 0
				has_character_flag = recent_minor_decision
				NOT = {
					had_character_flag = {
						flag = recent_minor_decision
						days = 730
					}
				}
			}	
			modifier = {
				factor = 0
				NOT = { age = 30 }
			}			
		}
	}
	observe_midnight_festival = { #festival from 3 to midnight, symbolising the sacrafice of hylia
		potential = {
			ai = no
			is_ruler = yes
			prisoner = no
			is_adult = yes
			religion = sheikahism
			NOT = {
				has_character_modifier = holding_religious_feastival
			}
			NOT = {
				has_character_modifier = large_feast_timer
			}
			NOT = {
				has_character_modifier = fabulous_feast
			}
			NOT = {
				has_character_flag = guest_religious_feastival_started
			}
			NOT = { trait = incapable }
			num_of_vassals = 1
		}
		allow = {
			war = no
			any_demesne_title = {
				is_occupied = no
			}
			prisoner = no
			NOT = { trait = in_hiding }
			scaled_wealth = 0.2
			month = 9
			prestige = 100
			custom_tooltip = {
				text = is_not_busy_trigger_tooltip
				hidden_tooltip = { NOT = { has_character_flag = do_not_disturb } }
			}
		}
		effect = {
			scaled_wealth = -0.2
			add_character_modifier = {
				name = holding_religious_feastival
				duration = 365
			}
			set_character_flag = recent_minor_decision
			set_character_flag = do_not_disturb
			hidden_tooltip = { character_event = { id = HKRC.x3 } }
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 0.1
			modifier = {
				factor = 0
				NOT = {
					scaled_wealth = 2
				}
			}
			modifier = {
				factor = 0.5
				trait = shy
			}
			modifier = {
				factor = 0.5
				NOT = { diplomacy = 10 }
			}	
			modifier = {
				factor = 0
				has_character_flag = recent_minor_decision
				NOT = {
					had_character_flag = {
						flag = recent_minor_decision
						days = 730
					}
				}
			}	
			modifier = {
				factor = 0
				NOT = { age = 30 }
			}			
		}
	}
	#alien festival
	observe_carnival_time = { #annual celebration from Terminia symbolising the harmony between nature and time
		potential = {
			ai = no
			is_ruler = yes
			prisoner = no
			is_adult = yes
			religion = goddess_time
			NOT = {
				has_character_modifier = holding_religious_feastival
			}
			NOT = {
				has_character_modifier = large_feast_timer
			}
			NOT = {
				has_character_modifier = fabulous_feast
			}
			NOT = {
				has_character_flag = guest_religious_feastival_started
			}
			NOT = { trait = incapable }
			num_of_vassals = 1
		}
		allow = {
			war = no
			any_demesne_title = {
				is_occupied = no
			}
			prisoner = no
			NOT = { trait = in_hiding }
			scaled_wealth = 0.2
			month = 9
			prestige = 100
			custom_tooltip = {
				text = is_not_busy_trigger_tooltip
				hidden_tooltip = { NOT = { has_character_flag = do_not_disturb } }
			}
		}
		effect = {
			scaled_wealth = -0.2
			add_character_modifier = {
				name = holding_religious_feastival
				duration = 365
			}
			set_character_flag = recent_minor_decision
			set_character_flag = do_not_disturb
			hidden_tooltip = { character_event = { id = HKRC.x3 } }
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 0.1
			modifier = {
				factor = 0
				NOT = {
					scaled_wealth = 2
				}
			}
			modifier = {
				factor = 0.5
				trait = shy
			}
			modifier = {
				factor = 0.5
				NOT = { diplomacy = 10 }
			}	
			modifier = {
				factor = 0
				has_character_flag = recent_minor_decision
				NOT = {
					had_character_flag = {
						flag = recent_minor_decision
						days = 730
					}
				}
			}	
			modifier = {
				factor = 0
				NOT = { age = 30 }
			}			
		}
	}	
}
